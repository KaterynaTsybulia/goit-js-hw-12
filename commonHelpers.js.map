{"version":3,"file":"commonHelpers.js","sources":["../src/js/render-functions.js","../src/js/pixabay-api.js","../src/main.js"],"sourcesContent":["\nexport const refs = {\n    searchForm: document.querySelector(\".js-search-form\"),\n    gallery: document.querySelector(\".js-gallery\"),\n    loader: document.querySelector(\".js-loader\"),\n    loadMoreBtn: document.querySelector(\".js-load-more-button\"),\n};\n\nexport function showLoader() {\n    refs.loader.classList.remove(\"is-hidden\");\n}\nexport function hideLoader() {\n    refs.loader.classList.add(\"is-hidden\");\n}\nexport function showButton() {\n    refs.loadMoreBtn.classList.remove(\"is-hidden\");\n}\nexport function hideButton() {\n    refs.loadMoreBtn.classList.add(\"is-hidden\");\n}\n\nexport function renderImage(hits) {\n    return hits.map(({webformatURL, largeImageURL, tags, likes, views, comments, downloads}) => `\n    <li class=\"gallery-card\">\n        <a class=\"gallery-link\" href=\"${largeImageURL}\">\n          <img\n            class=\"gallery-image\"\n            src=\"${webformatURL}\" \n            alt=\"${tags}\" \n            width=\"360\"\n            height=\"152\" \n          />\n        </a>\n        <div class=\"discribe-box\">\n          <ul class=\"discribe-list\">\n            <li class=\"discribe-item\">\n              <h2 class=\"discribe-title\">Likes</h2>\n              <p class=\"discribe-text\">${likes}</p>\n            </li>\n            <li class=\"discribe-item\">\n              <h2 class=\"discribe-title\">Views</h2>\n              <p class=\"discribe-text\">${views}</p>\n            </li>\n            <li class=\"discribe-item\">\n              <h2 class=\"discribe-title\">Comments</h2>\n              <p class=\"discribe-text\">${comments}</p>\n            </li>\n            <li class=\"discribe-item\">\n              <h2 class=\"discribe-title\">Downloads</h2>\n              <p class=\"discribe-text\">${downloads}</p>\n            </li>\n          </ul>\n        </div>\n      </li>\n    `).join(\"\");\n}\n\n    export function scrollGalerryCard() {\n        const galleryCardHeight = document.querySelector(\".gallery-card\").getBoundingClientRect().height;\n        \n        window.scrollBy({\n            top: Math.ceil(galleryCardHeight * 2),\n            left: Math.ceil(galleryCardHeight * 2),\n            behavior: \"smooth\",\n        });\n    }","\nimport axios from \"axios\";\n\nexport const apiParams = {\n    key: \"44994533-ffbdcdb8322be43f4ecb62ad3\",\n    q: \"\",\n    imageType: \"photo\",\n    orientation: \"horizontal\",\n    safesearch: true,\n    page: 1,\n    per_page: 15,\n    maxPage: 0,\n};\n\nexport async function createApiQuery() {\n    try {\n        const response = await axios.get(\"https://pixabay.com/api/\", { params: apiParams });\n        return response.data;\n    } catch (error) {\n        throw new Error(error.message);\n    }\n}\n\n\n","import iziToast from \"izitoast\";\nimport \"izitoast/dist/css/iziToast.min.css\";\nimport SimpleLightbox from \"simplelightbox\";\nimport \"simplelightbox/dist/simple-lightbox.min.css\";\n\nimport { refs, renderImage, showLoader, hideLoader, showButton, hideButton, scrollGalerryCard } from \"./js/render-functions\";\nimport { apiParams, createApiQuery } from \"./js/pixabay-api\";\n\nconst lightbox = new SimpleLightbox('.gallery a', {\n        captionDelay: 250,\n        captionPosition: \"bottom\",\n        captionsData: \"alt\",\n});\n\nhideLoader();\nhideButton();\n\nrefs.searchForm.addEventListener(\"submit\", handlerSearch);\n\nasync function handlerSearch(event) {\n    event.preventDefault();\n\n    refs.gallery.innerHTML = \"\";\n    apiParams.page = 1;\n    \n    showLoader();\n    hideButton();\n\n    const form = event.currentTarget;\n    apiParams.q = form.elements.searchtext.value.toLowerCase().trim();\n\n\n    if (!apiParams.q) {\n        iziToast.warning({\n            title: \"Caution\",\n            message: \"Please enter your request in the input field!\",\n            position: \"topRight\",\n        });\n        hideButton();\n        return;\n    }\n\n    try {\n        const { totalHits, hits } = await createApiQuery();\n\n        hideLoader();\n        apiParams.maxPage = Math.ceil(totalHits / apiParams.per_page);\n\n        refs.gallery.insertAdjacentHTML(\"beforeend\", renderImage(hits));\n        lightbox.refresh();\n\n        if (hits.length > 0 && hits.length !== totalHits) {\n            showButton();\n            refs.loadMoreBtn.addEventListener(\"click\", handlerLoadMore);\n        } else if (hits.length === 0) {\n            iziToast.error({\n                title: \"Error\",\n                message: \"Sorry, there are no images matching your search query. Please try again!\",\n                position: \"topRight\",\n            });\n        }\n    } catch (error) {\n        displayApiError();\n    } finally {\n        refs.searchForm.reset();\n    }\n}\n\nasync function handlerLoadMore() {\n    apiParams.page += 1;\n    showLoader(); \n    hideButton();\n\n    try {\n        const { hits } = await createApiQuery();\n        showButton();\n        hideLoader(); \n\n        refs.gallery.insertAdjacentHTML(\"beforeend\", renderImage(hits));\n        lightbox.refresh();\n        scrollGalerryCard();\n    } catch (error) {\n        displayApiError();\n    } finally {\n        if (apiParams.page === apiParams.maxPage) {\n            hideButton();\n            iziToast.info({\n                message: \"We're sorry, but you've reached the end of search results.\",\n                position: \"topRight\",\n            });\n            refs.loadMoreBtn.removeEventListener(\"click\", handlerLoadMore);\n        }\n    }\n}\n\nfunction displayApiError() {\n    iziToast.error({\n        title: \"Error\",\n        message: \"An error occurred while fetching images. Please try again later.\",\n        position: \"topRight\",\n    });\n}\n"],"names":["refs","showLoader","hideLoader","showButton","hideButton","renderImage","hits","webformatURL","largeImageURL","tags","likes","views","comments","downloads","scrollGalerryCard","galleryCardHeight","apiParams","createApiQuery","axios","error","lightbox","SimpleLightbox","handlerSearch","event","form","iziToast","totalHits","handlerLoadMore","displayApiError"],"mappings":"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"}